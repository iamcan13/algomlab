# ì‹¤ì‹œê°„ ë©´ì ‘ ì½”íŒŒì¼ëŸ¿ ìƒì„¸ êµ¬í˜„ ê°€ì´ë“œ (ì´ˆë³´ììš©)

> ì´ ë¬¸ì„œëŠ” ì›¹ ê°œë°œ ì´ˆë³´ìë¥¼ ìœ„í•´ ëª¨ë“  ê¸°ìˆ  ìš©ì–´ì™€ ê°œë…ì„ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.
> ê° ì½”ë“œ ë¸”ë¡ë§ˆë‹¤ í•´ë‹¹ íŒŒì¼ ìœ„ì¹˜ì™€ ë¼ì¸ ë²ˆí˜¸ë¥¼ ì°¸ì¡°í•˜ì—¬ ì‹¤ì œ ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ìš©ì–´ ì„¤ëª… (Glossary)

### ì›¹ ê°œë°œ ê¸°ë³¸ ìš©ì–´
- **ì»´í¬ë„ŒíŠ¸(Component)**: Reactì—ì„œ UIì˜ ë…ë¦½ì ì¸ ì¡°ê°. ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ ë¸”ë¡
- **í›…(Hook)**: React í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ ìƒíƒœì™€ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•˜ëŠ” í•¨ìˆ˜ (useState, useEffect ë“±)
- **ìƒíƒœ(State)**: ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ë³€ê²½ë  ìˆ˜ ìˆëŠ” ë°ì´í„°
- **í”„ë¡­ìŠ¤(Props)**: ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì‹ ì»´í¬ë„ŒíŠ¸ë¡œ ì „ë‹¬í•˜ëŠ” ë°ì´í„°
- **API**: ì„œë¡œ ë‹¤ë¥¸ ì†Œí”„íŠ¸ì›¨ì–´ê°€ í†µì‹ í•˜ê¸° ìœ„í•œ ê·œì¹™ê³¼ ë°©ë²•
- **WebSocket**: ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ ì„ ìœ„í•œ í”„ë¡œí† ì½œ (HTTPì™€ ë‹¬ë¦¬ ì—°ê²°ì´ ì§€ì†ë¨)

### AI/ML ê´€ë ¨ ìš©ì–´
- **STT (Speech-to-Text)**: ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ìˆ 
- **LLM (Large Language Model)**: GPTì™€ ê°™ì€ ëŒ€í˜• ì–¸ì–´ ëª¨ë¸
- **í”„ë¡¬í”„íŠ¸(Prompt)**: AIì—ê²Œ ì£¼ëŠ” ì§€ì‹œì‚¬í•­ì´ë‚˜ ì§ˆë¬¸
- **í† í°(Token)**: AIê°€ í…ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ìµœì†Œ ë‹¨ìœ„ (ë‹¨ì–´ë³´ë‹¤ ì‘ì„ ìˆ˜ ìˆìŒ)
- **Whisper**: OpenAIì—ì„œ ê°œë°œí•œ ìŒì„± ì¸ì‹ AI ëª¨ë¸

### ì˜¤ë””ì˜¤ ì²˜ë¦¬ ìš©ì–´
- **MediaRecorder**: ë¸Œë¼ìš°ì €ì—ì„œ ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ë¥¼ ë…¹ìŒí•˜ëŠ” API
- **Blob**: Binary Large Object, ì´ì§„ ë°ì´í„°ë¥¼ ë‹´ëŠ” ê°ì²´ (ì˜¤ë””ì˜¤ íŒŒì¼ ë“±)
- **ì²­í¬(Chunk)**: í° ë°ì´í„°ë¥¼ ì‘ì€ ì¡°ê°ìœ¼ë¡œ ë‚˜ëˆˆ ê²ƒ
- **ìƒ˜í”Œë§ ë ˆì´íŠ¸**: 1ì´ˆë‹¹ ì˜¤ë””ì˜¤ ì‹ í˜¸ë¥¼ ì¸¡ì •í•˜ëŠ” íšŸìˆ˜ (Hz ë‹¨ìœ„)

## ëª©ì°¨
1. [ì „ì²´ ì‹œìŠ¤í…œ ê°œìš”](#ì „ì²´-ì‹œìŠ¤í…œ-ê°œìš”)
2. [í”„ë¡ íŠ¸ì—”ë“œ UI êµ¬í˜„](#í”„ë¡ íŠ¸ì—”ë“œ-ui-êµ¬í˜„)
3. [ë°±ì—”ë“œ ì„œë¹„ìŠ¤ êµ¬í˜„](#ë°±ì—”ë“œ-ì„œë¹„ìŠ¤-êµ¬í˜„)
4. [ë°ì´í„° í”Œë¡œìš° ìƒì„¸ ë¶„ì„](#ë°ì´í„°-í”Œë¡œìš°-ìƒì„¸-ë¶„ì„)
5. [í™˜ê²½ ì„¤ì • ë° ë°°í¬](#í™˜ê²½-ì„¤ì •-ë°-ë°°í¬)

---

## ì „ì²´ ì‹œìŠ¤í…œ ê°œìš”

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
```
[ë§ˆì´í¬] â†’ [ì˜¤ë””ì˜¤ ìº¡ì²˜] â†’ [ì²­í¬ ìƒì„±] â†’ [WebSocket] â†’ [Whisper API] â†’ [í…ìŠ¤íŠ¸]
                                                            â†“
[UI ì—…ë°ì´íŠ¸] â† [WebSocket] â† [ê²°ê³¼ ë°˜í™˜] â† [GPT ë¶„ì„] â† [í…ìŠ¤íŠ¸ + í‰ê°€ ê¸°ì¤€]
```

### ê¸°ìˆ  ìŠ¤íƒ
- **í”„ë¡ íŠ¸ì—”ë“œ**: Next.js 15, React, TypeScript, Tailwind CSS
- **ë°±ì—”ë“œ**: Node.js, Express, WebSocket, TypeScript
- **AI ì„œë¹„ìŠ¤**: OpenAI Whisper (STT), GPT-4o-mini (ë¶„ì„)
- **í†µì‹ **: WebSocket (ì‹¤ì‹œê°„), REST API (ì„¤ì •)

---

## í”„ë¡ íŠ¸ì—”ë“œ UI êµ¬í˜„

### 1. ë©”ì¸ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ (`src/app/page.tsx`)

#### ì „ì²´ êµ¬ì¡° ì´í•´
```typescript
export default function Home() {
  // ìƒíƒœ ê´€ë¦¬
  const [template, setTemplate] = useState<InterviewTemplate | null>(null);
  const [copyFeedback, setCopyFeedback] = useState<string | null>(null);
  
  // ì»¤ìŠ¤í…€ í›… ì‚¬ìš©
  const { isConnected, transcriptions, ... } = useWebSocket();
  const { isRecording, hasPermission, ... } = useAudioCapture();
```

**ì™œ ì´ë ‡ê²Œ êµ¬ì„±í–ˆë‚˜ìš”?**
- `useState`: ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ í›…: ë³µì¡í•œ ë¡œì§ì„ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.

#### 3ë¶„í•  ë ˆì´ì•„ì›ƒ êµ¬ì¡°
```typescript
<main className="flex-1 flex overflow-hidden">
  {/* ì¢Œì¸¡: ì‹¤ì‹œê°„ í…ìŠ¤íŠ¸ ìŠ¤íŠ¸ë¦¼ (1/3) */}
  <div className="w-1/3 bg-white border-r p-6">
    <Transcript transcriptions={transcriptions} isRecording={isRecording} />
  </div>

  {/* ì¤‘ì•™: í‰ê°€ ê¸°ì¤€ ì¹´ë“œë“¤ (1/3) */}
  <div className="w-1/3 bg-gray-50 p-6">
    <CriteriaBoard criteria={template?.criteria || []} progress={progress} />
  </div>

  {/* ìš°ì¸¡: ì œì•ˆ ì§ˆë¬¸ íŒ¨ë„ (1/3) */}
  <div className="w-1/3 bg-white border-l p-6">
    <NextQuestions questions={nextQuestions} onCopyQuestion={handleCopyQuestion} />
  </div>
</main>
```

**CSS í´ë˜ìŠ¤ ì„¤ëª…:**
- `flex-1`: ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€
- `flex`: flexbox ë ˆì´ì•„ì›ƒ ì‚¬ìš©
- `w-1/3`: ë„ˆë¹„ë¥¼ 1/3ë¡œ ì„¤ì •
- `overflow-hidden`: ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€

### 2. ì¢Œì¸¡ íŒ¨ë„: ì‹¤ì‹œê°„ ì „ì‚¬ (`src/components/Transcript.tsx`)

#### ë°ì´í„° íƒ€ì… ì •ì˜
```typescript
interface TranscriptItem {
  sequence: number;    // ì²­í¬ ìˆœì„œ ë²ˆí˜¸ (1, 2, 3, ...)
  text: string;       // Whisperê°€ ë³€í™˜í•œ í…ìŠ¤íŠ¸
  timestamp: number;  // ì „ì‚¬ ì™„ë£Œ ì‹œì  (ë°€ë¦¬ì´ˆ)
}
```

**ê° í•„ë“œê°€ í•„ìš”í•œ ì´ìœ :**
- `sequence`: ì²­í¬ ìˆœì„œë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´
- `text`: ì‹¤ì œ ì „ì‚¬ëœ ë‚´ìš©
- `timestamp`: ì–¸ì œ ë§í–ˆëŠ”ì§€ ì‹œê°„ ì •ë³´ ì œê³µ

#### ìë™ ìŠ¤í¬ë¡¤ êµ¬í˜„ (ì˜¤ëŠ˜ ì¶”ê°€ëœ ê¸°ëŠ¥)
```typescript
const scrollRef = useRef<HTMLDivElement>(null);

useEffect(() => {
  if (scrollRef.current) {
    scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
  }
}, [transcriptions]);
```

**ì½”ë“œ í•´ì„:**
1. `useRef`: DOM ìš”ì†Œì— ì§ì ‘ ì ‘ê·¼í•˜ê¸° ìœ„í•œ React í›…
2. `useEffect`: `transcriptions` ë°°ì—´ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰
3. `scrollTop = scrollHeight`: ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ ì´ë™

#### ì „ì‚¬ í•­ëª© ë Œë”ë§
```typescript
{transcriptions.map((transcription) => (
  <div key={transcription.sequence} className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
    {/* ìˆœì„œ ë²ˆí˜¸ ë°°ì§€ */}
    <span className="flex-shrink-0 w-7 h-7 bg-blue-500 text-white text-xs font-medium rounded-full flex items-center justify-center">
      {transcription.sequence}
    </span>
    
    <div className="flex-1 min-w-0">
      {/* ì „ì‚¬ëœ í…ìŠ¤íŠ¸ */}
      <p className="text-gray-800 leading-relaxed">{transcription.text}</p>
      {/* ì‹œê°„ ì •ë³´ */}
      <p className="text-xs text-gray-500 mt-1">
        {new Date(transcription.timestamp).toLocaleTimeString()}
      </p>
    </div>
  </div>
))}
```

**UI ë””ìì¸ ì›ì¹™:**
- ìˆœì„œ ë²ˆí˜¸ë¥¼ ì‹œê°ì ìœ¼ë¡œ ê°•ì¡° (íŒŒë€ìƒ‰ ì›í˜• ë°°ì§€)
- í…ìŠ¤íŠ¸ëŠ” ì½ê¸° ì‰½ê²Œ ì¶©ë¶„í•œ í–‰ê°„ ì„¤ì •
- ì‹œê°„ ì •ë³´ëŠ” ì‘ê³  ì—°í•œ ìƒ‰ìœ¼ë¡œ í‘œì‹œ

#### ì „ì²´ ë³µì‚¬ ê¸°ëŠ¥
```typescript
const handleCopyAll = () => {
  const fullText = transcriptions.map(t => t.text).join(' ');
  navigator.clipboard.writeText(fullText);
};
```

**ë™ì‘ ê³¼ì •:**
1. ëª¨ë“  ì „ì‚¬ í•­ëª©ì˜ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œ
2. ê³µë°±ìœ¼ë¡œ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ë¬¸ìì—´ ìƒì„±
3. ë¸Œë¼ìš°ì € í´ë¦½ë³´ë“œ APIë¡œ ë³µì‚¬

### 3. ì¤‘ì•™ íŒ¨ë„: í‰ê°€ ê¸°ì¤€ ëŒ€ì‹œë³´ë“œ (`src/components/CriteriaBoard.tsx`)

#### í‰ê°€ ê¸°ì¤€ ë°ì´í„° êµ¬ì¡°
```typescript
type CriteriaStatus = 'unknown' | 'weak' | 'covered';

interface Criteria {
  id: string;           // ê³ ìœ  ì‹ë³„ì (ì˜ˆ: 'js_fundamentals')
  label: string;        // í™”ë©´ í‘œì‹œëª… (ì˜ˆ: 'JavaScript ê¸°ì´ˆ')
  weight: number;       // ì¤‘ìš”ë„ (1-10 ì ìˆ˜)
  rubric: string;       // í‰ê°€ ê¸°ì¤€ ìƒì„¸ ì„¤ëª…
  status: CriteriaStatus; // í˜„ì¬ í‰ê°€ ìƒíƒœ
  evidence: string[];   // í‰ê°€ ê·¼ê±° ëª©ë¡
}
```

**ìƒíƒœ ë³€í™” íë¦„:**
```
unknown (ì •ë³´ ì—†ìŒ) â†’ weak (ë¶€ì¡±í•¨) â†’ covered (ì¶©ì¡±í•¨)
```

#### ì§„í–‰ë¥  ê³„ì‚° ë¡œì§
```typescript
interface Progress {
  total: number;        // ì „ì²´ ê¸°ì¤€ ê°œìˆ˜
  covered: number;      // ì¶©ì¡±ëœ ê¸°ì¤€ ê°œìˆ˜
  weak: number;         // ë¶€ì¡±í•œ ê¸°ì¤€ ê°œìˆ˜
  unknown: number;      // ë¯¸í‰ê°€ ê¸°ì¤€ ê°œìˆ˜
  percentage: number;   // ì „ì²´ ì™„ë£Œìœ¨ (covered / total * 100)
}
```

#### ìƒíƒœë³„ ìƒ‰ìƒ ì‹œìŠ¤í…œ
```typescript
const getStatusColor = (status: CriteriaStatus) => {
  switch (status) {
    case 'covered': 
      return 'bg-green-100 border-green-300 text-green-800';  // ì´ˆë¡: ì¶©ì¡±
    case 'weak': 
      return 'bg-yellow-100 border-yellow-300 text-yellow-800'; // ë…¸ë‘: ë¶€ì¡±
    case 'unknown': 
      return 'bg-gray-100 border-gray-300 text-gray-600';     // íšŒìƒ‰: ë¯¸í‰ê°€
  }
}
```

**ìƒ‰ìƒ ì„ íƒ ì´ìœ :**
- ì´ˆë¡: ì„±ê³µ, ì™„ë£Œë¥¼ ì§ê´€ì ìœ¼ë¡œ í‘œí˜„
- ë…¸ë‘: ì£¼ì˜, ê°œì„  í•„ìš”ë¥¼ ë‚˜íƒ€ëƒ„
- íšŒìƒ‰: ì¤‘ë¦½, ì •ë³´ ë¶€ì¡±ì„ ì˜ë¯¸

#### ê¸°ì¤€ ì¹´ë“œ ë Œë”ë§
```typescript
{criteria.map((criterion) => (
  <div key={criterion.id} className={`p-4 rounded-lg border-2 ${getStatusColor(criterion.status)}`}>
    <div className="flex items-center justify-between mb-2">
      {/* ê¸°ì¤€ ì´ë¦„ */}
      <h3 className="font-medium">{criterion.label}</h3>
      {/* ì¤‘ìš”ë„ í‘œì‹œ */}
      <span className="text-xs px-2 py-1 bg-white rounded">
        ê°€ì¤‘ì¹˜ {criterion.weight}
      </span>
    </div>
    
    {/* í‰ê°€ ê¸°ì¤€ ì„¤ëª… */}
    <p className="text-sm mb-3">{criterion.rubric}</p>
    
    {/* ì¦ê±° ëª©ë¡ (ìˆëŠ” ê²½ìš°ë§Œ) */}
    {criterion.evidence.length > 0 && (
      <div>
        <p className="text-xs font-medium mb-1">ì¦ê±°:</p>
        <ul className="text-xs space-y-1">
          {criterion.evidence.map((evidence, index) => (
            <li key={index} className="flex items-start">
              <span className="mr-1">â€¢</span>
              <span>{evidence}</span>
            </li>
          ))}
        </ul>
      </div>
    )}
  </div>
))}
```

### 4. ìš°ì¸¡ íŒ¨ë„: ì œì•ˆ ì§ˆë¬¸ (`src/components/NextQuestions.tsx`)

#### ì§ˆë¬¸ ë°ì´í„° êµ¬ì¡°
```typescript
interface NextQuestion {
  id: string;          // ê´€ë ¨ëœ í‰ê°€ ê¸°ì¤€ ID
  ask: string;         // ì‹¤ì œ ì§ˆë¬¸ ë‚´ìš©
}
```

#### ì§ˆë¬¸ ì¹´ë“œ UI
```typescript
{questions.map((question) => (
  <div key={question.id} className="border rounded-lg p-4 hover:bg-gray-50 transition-colors">
    <div className="flex items-start justify-between">
      <div className="flex-1">
        {/* ì§ˆë¬¸ ë‚´ìš© */}
        <p className="text-gray-800 leading-relaxed">{question.ask}</p>
        {/* ê´€ë ¨ ê¸°ì¤€ í‘œì‹œ */}
        <p className="text-xs text-gray-500 mt-2">ê¸°ì¤€: {question.id}</p>
      </div>
      
      {/* ë³µì‚¬ ë²„íŠ¼ */}
      <button 
        onClick={() => handleCopyQuestion(question.ask)}
        className="ml-3 text-gray-400 hover:text-gray-600"
      >
        ğŸ“‹
      </button>
    </div>
  </div>
))}
```

**UX ë””ìì¸ ê³ ë ¤ì‚¬í•­:**
- `hover:bg-gray-50`: ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ ë³€í™”ë¡œ ìƒí˜¸ì‘ìš© í‘œì‹œ
- `transition-colors`: ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ ì „í™˜ íš¨ê³¼
- ë³µì‚¬ ë²„íŠ¼ì„ ìš°ì¸¡ì— ë°°ì¹˜í•˜ì—¬ ì§ê´€ì ì¸ ì ‘ê·¼

#### ì§ˆë¬¸ ë³µì‚¬ ê¸°ëŠ¥
```typescript
const handleCopyQuestion = (questionText: string) => {
  navigator.clipboard.writeText(questionText);
  onCopyQuestion(`ì§ˆë¬¸ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤: "${questionText.substring(0, 30)}..."`);
};
```

**ì‚¬ìš©ì í”¼ë“œë°± ì œê³µ:**
1. í´ë¦½ë³´ë“œì— ì§ˆë¬¸ ë³µì‚¬
2. ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì„±ê³µ ë©”ì‹œì§€ ì „ë‹¬
3. ì§ˆë¬¸ ì•ë¶€ë¶„ 30ìë§Œ ë¯¸ë¦¬ë³´ê¸°ë¡œ í‘œì‹œ

---

## ë°±ì—”ë“œ ì„œë¹„ìŠ¤ êµ¬í˜„

### 1. ì˜¤ë””ì˜¤ ìº¡ì²˜ ì‹œìŠ¤í…œ (`src/hooks/useAudioCapture.ts`)

#### í™˜ê²½ë³€ìˆ˜ ê¸°ë°˜ ì„¤ì • (ì˜¤ëŠ˜ ê°œì„ ëœ ê¸°ëŠ¥)
```typescript
// í™˜ê²½ë³€ìˆ˜ì—ì„œ ì²­í¬ ì§€ì†ì‹œê°„ ì½ê¸° (ê¸°ë³¸ê°’: 5ì´ˆ)
const chunkDurationMs = parseInt(
  process.env.NEXT_PUBLIC_AUDIO_CHUNK_DURATION_SECONDS || '5'
) * 1000;
```

**í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© ì´ìœ :**
- ê°œë°œ/ìŠ¤í…Œì´ì§•/í”„ë¡œë•ì…˜ í™˜ê²½ë§ˆë‹¤ ë‹¤ë¥¸ ì„¤ì • ê°€ëŠ¥
- ì½”ë“œ ë³€ê²½ ì—†ì´ ì„±ëŠ¥ íŠœë‹ ê°€ëŠ¥
- ë°°í¬ í›„ì—ë„ ì„¤ì • ì¡°ì • ê°€ëŠ¥

#### MediaRecorder ì„¤ì •
```typescript
const recorder = new MediaRecorder(audioStream, {
  mimeType: supportedMimeType,    // ì§€ì›ë˜ëŠ” ì˜¤ë””ì˜¤ í¬ë§·
  audioBitsPerSecond: 128000      // ìŒì§ˆê³¼ íŒŒì¼ í¬ê¸°ì˜ ê· í˜•
});
```

**ì˜¤ë””ì˜¤ í¬ë§· ìš°ì„ ìˆœìœ„:**
1. `audio/wav`: ìµœê³  í’ˆì§ˆ, í° íŒŒì¼ í¬ê¸°
2. `audio/webm;codecs=opus`: ì¢‹ì€ ì••ì¶•ë¥ 
3. `audio/webm`: ê¸°ë³¸ WebM í¬ë§·

#### ë…ë¦½ì ì¸ ì²­í¬ ìƒì„± ì‹œìŠ¤í…œ
```typescript
const createChunk = useCallback(() => {
  if (!streamRef.current || !isRecordingRef.current) return;
  
  // í˜„ì¬ MediaRecorder ì¤‘ì§€
  if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {
    mediaRecorderRef.current.stop();
  }
  
  // ìƒˆë¡œìš´ MediaRecorderë¡œ ë‹¤ìŒ ì²­í¬ ì‹œì‘
  setTimeout(() => {
    if (!streamRef.current || !isRecordingRef.current) return;
    
    const newRecorder = createMediaRecorder(streamRef.current);
    mediaRecorderRef.current = newRecorder;
    newRecorder.start();
  }, 100); // 100ms ê°„ê²©ìœ¼ë¡œ ì—°ì†ì„± ë³´ì¥
}, [createMediaRecorder]);
```

**ì™œ ë…ë¦½ì ì¸ ì²­í¬ì¸ê°€ìš”?**
- ê° ì²­í¬ê°€ ë³„ë„ì˜ íŒŒì¼ë¡œ ìƒì„±ë¨
- ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ í•˜ë‚˜ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ì²­í¬ëŠ” ì˜í–¥ ì—†ìŒ
- ì‹¤ì‹œê°„ ì²˜ë¦¬ì— ìµœì í™”ë¨

#### ë§ˆì´í¬ ê¶Œí•œ ê´€ë¦¬
```typescript
const requestPermission = useCallback(async (): Promise<boolean> => {
  try {
    setError(null);
    console.log('ë§ˆì´í¬ ê¶Œí•œ ìš”ì²­ ì¤‘...');
    
    const stream = await navigator.mediaDevices.getUserMedia({ 
      audio: {
        sampleRate: 16000,        // Whisper ìµœì í™”
        channelCount: 1,          // ëª¨ë…¸ ì˜¤ë””ì˜¤
        echoCancellation: true,   // ì—ì½” ì œê±°
        noiseSuppression: true    // ë…¸ì´ì¦ˆ ì œê±°
      } 
    });
    
    streamRef.current = stream;
    setHasPermission(true);
    console.log('ë§ˆì´í¬ ê¶Œí•œ ìŠ¹ì¸ë¨');
    
    return true;
  } catch (err) {
    console.error('ë§ˆì´í¬ ê¶Œí•œ ê±°ë¶€:', err);
    setError('ë§ˆì´í¬ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
    setHasPermission(false);
    return false;
  }
}, []);
```

### 2. WebSocket í†µì‹  (`src/hooks/useWebSocket.ts`)

#### ì—°ê²° ê´€ë¦¬
```typescript
const connect = useCallback(() => {
  try {
    const ws = new WebSocket(WS_URL);  // ws://localhost:8080
    
    ws.onopen = () => {
      console.log('WebSocket ì—°ê²°ë¨');
      setIsConnected(true);
    };
    
    ws.onmessage = (event) => {
      const message = JSON.parse(event.data);
      handleMessage(message);
    };
    
    ws.onclose = () => {
      console.log('WebSocket ì—°ê²° ì¢…ë£Œ');
      setIsConnected(false);
    };
    
    ws.onerror = (error) => {
      console.error('WebSocket ì˜¤ë¥˜:', error);
      setIsConnected(false);
    };
    
    wsRef.current = ws;
  } catch (error) {
    console.error('WebSocket ì—°ê²° ì‹¤íŒ¨:', error);
  }
}, []);
```

#### ë©”ì‹œì§€ íƒ€ì…ë³„ ì²˜ë¦¬
```typescript
const handleMessage = useCallback((message: any) => {
  switch (message.type) {
    case 'transcription':
      setTranscriptions(prev => [...prev, message.data]);
      break;
      
    case 'criteria_update':
      setCriteriaUpdates(prev => [...prev, ...message.data]);
      break;
      
    case 'next_questions':
      setNextQuestions(message.data);
      break;
      
    case 'progress_update':
      setProgress(message.data);
      break;
      
    default:
      console.warn('ì•Œ ìˆ˜ ì—†ëŠ” ë©”ì‹œì§€ íƒ€ì…:', message.type);
  }
}, []);
```

#### ì˜¤ë””ì˜¤ ì²­í¬ ì „ì†¡
```typescript
const sendAudioChunk = useCallback((blob: Blob, sessionId: string, sequence: number) => {
  if (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) {
    console.error('WebSocketì´ ì—°ê²°ë˜ì§€ ì•ŠìŒ');
    return;
  }

  // Blobì„ ArrayBufferë¡œ ë³€í™˜
  blob.arrayBuffer().then(arrayBuffer => {
    const message = {
      type: 'audio_chunk',
      sessionId,
      sequence,
      audioData: Array.from(new Uint8Array(arrayBuffer))  // ì´ì§„ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ë³€í™˜
    };
    
    wsRef.current?.send(JSON.stringify(message));
    
    // í†µê³„ ì—…ë°ì´íŠ¸
    setChunkCount(prev => prev + 1);
    setTotalSize(prev => prev + blob.size);
  });
}, []);
```

### 3. ì„œë²„ì‚¬ì´ë“œ Whisper ì²˜ë¦¬ (`server/src/WhisperService.ts`)

#### Whisper API í˜¸ì¶œ
```typescript
async transcribeAudio(audioBuffer: Buffer, filename: string): Promise<string | null> {
  try {
    console.log(`Whisper ì „ì‚¬ ì‹œì‘: ${filename} (${audioBuffer.length} bytes)`);
    
    // ì„ì‹œ íŒŒì¼ ìƒì„±
    const tempPath = path.join(os.tmpdir(), filename);
    fs.writeFileSync(tempPath, audioBuffer);
    
    try {
      // OpenAI Whisper API í˜¸ì¶œ
      const response = await this.openai.audio.transcriptions.create({
        file: fs.createReadStream(tempPath),
        model: this.model,      // 'whisper-1'
        language: 'ko',         // í•œêµ­ì–´ ìš°ì„ 
        response_format: 'text' // ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ ë°˜í™˜
      });
      
      console.log(`Whisper ì „ì‚¬ ì™„ë£Œ: "${response.substring(0, 100)}..."`);
      return response;
      
    } finally {
      // ì„ì‹œ íŒŒì¼ ì •ë¦¬
      if (fs.existsSync(tempPath)) {
        fs.unlinkSync(tempPath);
      }
    }
    
  } catch (error) {
    console.error('Whisper ì „ì‚¬ ì‹¤íŒ¨:', error);
    return null;
  }
}
```

**ì²˜ë¦¬ ê³¼ì •:**
1. ë©”ëª¨ë¦¬ì˜ ì˜¤ë””ì˜¤ ë°ì´í„°ë¥¼ ì„ì‹œ íŒŒì¼ë¡œ ì €ì¥
2. Whisper APIì— íŒŒì¼ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „ì†¡
3. í…ìŠ¤íŠ¸ ê²°ê³¼ ë°›ê¸°
4. ì„ì‹œ íŒŒì¼ ì •ë¦¬ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)

### 4. LLM ë¶„ì„ ì—”ì§„ (`server/src/LLMMapper.ts`)

#### ê³ ê¸‰ íŠ¸ë ˆì´ì‹± ì‹œìŠ¤í…œ (ì˜¤ëŠ˜ êµ¬í˜„ëœ ê¸°ëŠ¥)
```typescript
async processTranscript(
  transcript: string,
  template: InterviewTemplate,
  conversationHistory: string[] = []
): Promise<LLMResponse | null> {
  const startTime = Date.now();
  const requestId = Math.random().toString(36).substr(2, 9);
  
  // ğŸš€ ìš”ì²­ ì‹œì‘ ë¡œê¹…
  console.log(`\nğŸš€ [LLM-${requestId}] í˜¸ì¶œ ì‹œì‘`);
  console.log(`ğŸ“ [LLM-${requestId}] ì…ë ¥ í…ìŠ¤íŠ¸: "${transcript.substring(0, 100)}..."`);
  console.log(`ğŸ“Š [LLM-${requestId}] í…œí”Œë¦¿: ${template.role} (${template.criteria.length}ê°œ ê¸°ì¤€)`);
  console.log(`ğŸ§  [LLM-${requestId}] ëª¨ë¸: ${this.model}`);
  
  try {
    const prompt = this.buildPrompt(transcript, template, conversationHistory);
    console.log(`ğŸ“„ [LLM-${requestId}] í”„ë¡¬í”„íŠ¸ ê¸¸ì´: ${prompt.length}ì`);
    
    // â±ï¸ API í˜¸ì¶œ ì‹œê°„ ì¸¡ì •
    const apiCallStart = Date.now();
    const response = await this.openai.chat.completions.create({
      model: this.model,
      messages: [{ role: 'user', content: prompt }],
      temperature: 0.3,               // ì¼ê´€ì„±ì„ ìœ„í•œ ë‚®ì€ ì°½ì˜ì„±
      max_tokens: 1000,               // JSON ì‘ë‹µì— ì¶©ë¶„í•œ í† í°
      response_format: { type: 'json_object' }  // JSON ê°•ì œ
    });

    const apiCallTime = Date.now() - apiCallStart;
    console.log(`â±ï¸ [LLM-${requestId}] API í˜¸ì¶œ ì‹œê°„: ${apiCallTime}ms`);
    
    // ğŸ’° í† í° ì‚¬ìš©ëŸ‰ ì¶”ì 
    if (response.usage) {
      console.log(`ğŸ’° [LLM-${requestId}] í† í° ì‚¬ìš©ëŸ‰: ${response.usage.prompt_tokens} + ${response.usage.completion_tokens} = ${response.usage.total_tokens}`);
    }

    // ì‘ë‹µ ì²˜ë¦¬ ë° ê²€ì¦
    const content = response.choices[0]?.message?.content;
    if (!content) {
      throw new Error('OpenAI ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤');
    }

    console.log(`ğŸ“¤ [LLM-${requestId}] ì‘ë‹µ ê¸¸ì´: ${content.length}ì`);
    
    const llmResponse: LLMResponse = JSON.parse(content);
    
    if (!this.validateLLMResponse(llmResponse)) {
      throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ LLM ì‘ë‹µ í˜•ì‹');
    }

    // âœ… ì„±ê³µ ë¡œê¹…
    const totalTime = Date.now() - startTime;
    console.log(`âœ… [LLM-${requestId}] ì²˜ë¦¬ ì™„ë£Œ: ${llmResponse.criteria_updates.length}ê°œ ê¸°ì¤€ ì—…ë°ì´íŠ¸, ${llmResponse.next_questions.length}ê°œ ì§ˆë¬¸ ìƒì„±`);
    console.log(`â±ï¸ [LLM-${requestId}] ì´ ì²˜ë¦¬ ì‹œê°„: ${totalTime}ms\n`);
    
    return llmResponse;

  } catch (error) {
    // âŒ ì—ëŸ¬ ìƒì„¸ ë¡œê¹…
    const totalTime = Date.now() - startTime;
    console.error(`âŒ [LLM-${requestId}] ì²˜ë¦¬ ì‹¤íŒ¨ (${totalTime}ms):`, error);
    console.error(`ğŸ” [LLM-${requestId}] ì—ëŸ¬ ìƒì„¸:`, {
      message: error instanceof Error ? error.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜',
      type: error instanceof Error ? error.constructor.name : typeof error,
      stack: error instanceof Error ? error.stack?.split('\n').slice(0, 3).join('\n') : undefined
    });
    console.log(`\n`);
    return null;
  }
}
```

#### ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„¸ ë¶„ì„
```typescript
private buildPrompt(
  transcript: string,
  template: InterviewTemplate,
  conversationHistory: string[]
): string {
  // í˜„ì¬ í‰ê°€ ê¸°ì¤€ë“¤ì„ ë¬¸ìì—´ë¡œ í¬ë§·íŒ…
  const criteriaList = template.criteria
    .map(c => `- ${c.id}: ${c.label} (${c.rubric}) [í˜„ì¬: ${c.status}]`)
    .join('\n');

  // ìµœê·¼ 5ê°œ ëŒ€í™”ë§Œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš© (í† í° ì ˆì•½)
  const historyText = conversationHistory.length > 0 
    ? `\n\nì´ì „ ëŒ€í™”:\n${conversationHistory.slice(-5).join('\n')}`
    : '';

  return `
ë‹¹ì‹ ì€ ${template.role} ë©´ì ‘ì„ í‰ê°€í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

í‰ê°€ ê¸°ì¤€:
${criteriaList}

í˜„ì¬ ë©´ì ‘ìì˜ ë‹µë³€:
"${transcript}"
${historyText}

ì§€ì‹œì‚¬í•­:
1. ë‹µë³€ì„ ë¶„ì„í•˜ì—¬ ê° í‰ê°€ ê¸°ì¤€ì— ëŒ€í•œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”
2. ìƒíƒœ: unknown(ì •ë³´ì—†ìŒ) â†’ weak(ë¶€ì¡±í•¨) â†’ covered(ì¶©ì¡±í•¨)
3. evidenceëŠ” êµ¬ì²´ì ì´ê³  ê°ê´€ì ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”
4. confidenceëŠ” 0.0-1.0 ì‚¬ì´ë¡œ í‰ê°€í•˜ì„¸ìš”
5. ë¯¸ê²€ì¦/ì•½í•œ ê¸°ì¤€ì— ëŒ€í•´ 1-2ê°œì˜ ì§ˆë¬¸ì„ ì œì•ˆí•˜ì„¸ìš”
6. ì§ˆë¬¸ì€ í•œêµ­ì–´ë¡œ ì§ì„¤ì ì´ê³  ëª…í™•í•˜ê²Œ ì‘ì„±í•˜ì„¸ìš”

ì‘ë‹µì€ ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:
{
  "criteria_updates": [
    {
      "id": "ê¸°ì¤€_id",
      "status": "unknown|weak|covered",
      "evidence": ["êµ¬ì²´ì ì¸ ê·¼ê±°1", "êµ¬ì²´ì ì¸ ê·¼ê±°2"],
      "confidence": 0.85
    }
  ],
  "next_questions": [
    {
      "id": "ê¸°ì¤€_id",
      "ask": "ëª…í™•í•˜ê³  êµ¬ì²´ì ì¸ ì§ˆë¬¸"
    }
  ]
}

ì¤‘ìš”: ë‹µë³€ì—ì„œ ì–¸ê¸‰ë˜ì§€ ì•Šì€ ê¸°ì¤€ì€ ì—…ë°ì´íŠ¸í•˜ì§€ ë§ˆì„¸ìš”. ì¶”ì¸¡ì´ë‚˜ ê°€ì •ìœ¼ë¡œ í‰ê°€í•˜ì§€ ë§ˆì„¸ìš”.
`;
}
```

**í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ì›ì¹™:**
1. **ì—­í•  ëª…í™•í™”**: "ì „ë¬¸ê°€" ì—­í•  ë¶€ì—¬ë¡œ í’ˆì§ˆ í–¥ìƒ
2. **ë‹¨ê³„ì  ì§€ì¹¨**: 1-6ë²ˆê¹Œì§€ ëª…í™•í•œ ì‘ì—… ìˆœì„œ
3. **ì œì•½ì‚¬í•­ ëª…ì‹œ**: JSON í˜•ì‹ ê°•ì œ, ì¶”ì¸¡ ê¸ˆì§€
4. **ì»¨í…ìŠ¤íŠ¸ ì œí•œ**: ìµœê·¼ 5ê°œ ëŒ€í™”ë§Œ ì‚¬ìš©í•´ í† í° ì ˆì•½

#### ì‘ë‹µ ê²€ì¦ ì‹œìŠ¤í…œ
```typescript
private validateLLMResponse(response: any): response is LLMResponse {
  if (!response || typeof response !== 'object') {
    return false;
  }

  // criteria_updates ë°°ì—´ ê²€ì¦
  if (!Array.isArray(response.criteria_updates)) {
    return false;
  }

  for (const update of response.criteria_updates) {
    // í•„ìˆ˜ í•„ë“œ ì¡´ì¬ í™•ì¸
    if (!update.id || !update.status || !Array.isArray(update.evidence)) {
      return false;
    }
    
    // ìƒíƒœ ê°’ ìœ íš¨ì„± ê²€ì¦
    if (!['unknown', 'weak', 'covered'].includes(update.status)) {
      return false;
    }
    
    // ì‹ ë¢°ë„ ë²”ìœ„ ê²€ì¦
    if (typeof update.confidence !== 'number' || update.confidence < 0 || update.confidence > 1) {
      return false;
    }
  }

  // next_questions ë°°ì—´ ê²€ì¦
  if (!Array.isArray(response.next_questions)) {
    return false;
  }

  for (const question of response.next_questions) {
    if (!question.id || !question.ask) {
      return false;
    }
  }

  return true;
}
```

### 5. í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ (`server/src/CriteriaManager.ts`)

#### ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§
```typescript
applyCriteriaUpdates(updates: CriteriaUpdate[]): void {
  updates.forEach(update => {
    const criterion = this.currentCriteria.find(c => c.id === update.id);
    if (!criterion) {
      console.warn(`ê¸°ì¤€ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${update.id}`);
      return;
    }

    // ìƒíƒœ ì—…ê·¸ë ˆì´ë“œë§Œ í—ˆìš© (ë˜ëŒë¦¬ê¸° ë°©ì§€)
    if (this.canUpgradeStatus(criterion.status, update.status)) {
      console.log(`ê¸°ì¤€ ì—…ë°ì´íŠ¸: ${update.id} ${criterion.status} â†’ ${update.status}`);
      
      criterion.status = update.status;
      criterion.evidence = [...criterion.evidence, ...update.evidence];
      
      // ì¤‘ë³µ ì¦ê±° ì œê±°
      criterion.evidence = [...new Set(criterion.evidence)];
    }
  });
}

private canUpgradeStatus(current: CriteriaStatus, proposed: CriteriaStatus): boolean {
  const statusHierarchy = { unknown: 0, weak: 1, covered: 2 };
  return statusHierarchy[proposed] >= statusHierarchy[current];
}
```

**ìƒíƒœ ì—…ê·¸ë ˆì´ë“œ ì›ì¹™:**
- `unknown` â†’ `weak` âœ…
- `unknown` â†’ `covered` âœ…
- `weak` â†’ `covered` âœ…
- `covered` â†’ `weak` âŒ (ë˜ëŒë¦¬ê¸° ë°©ì§€)

---

## ë°ì´í„° í”Œë¡œìš° ìƒì„¸ ë¶„ì„

### 1. ì˜¤ë””ì˜¤ â†’ í…ìŠ¤íŠ¸ íŒŒì´í”„ë¼ì¸

```mermaid
graph TD
    A[ë§ˆì´í¬ ì…ë ¥] --> B[MediaRecorder]
    B --> C[5ì´ˆ ì²­í¬ ìƒì„±]
    C --> D[WebSocket ì „ì†¡]
    D --> E[ì„œë²„ ìˆ˜ì‹ ]
    E --> F[Whisper API]
    F --> G[í…ìŠ¤íŠ¸ ê²°ê³¼]
    G --> H[í´ë¼ì´ì–¸íŠ¸ ì „ì†¡]
    H --> I[UI ì—…ë°ì´íŠ¸]
```

**ê° ë‹¨ê³„ ìƒì„¸:**

1. **ë§ˆì´í¬ ì…ë ¥**: ë¸Œë¼ìš°ì € MediaDevices APIë¡œ ì˜¤ë””ì˜¤ ìŠ¤íŠ¸ë¦¼ ìº¡ì²˜
2. **MediaRecorder**: ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ë¥¼ Blob í˜•íƒœë¡œ ë…¹ìŒ
3. **ì²­í¬ ìƒì„±**: í™˜ê²½ë³€ìˆ˜ ì„¤ì •ëœ ê°„ê²©(ê¸°ë³¸ 5ì´ˆ)ìœ¼ë¡œ ë…ë¦½ì ì¸ ì²­í¬ ìƒì„±
4. **WebSocket ì „ì†¡**: ì´ì§„ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì‹¤ì‹œê°„ ì „ì†¡
5. **ì„œë²„ ìˆ˜ì‹ **: Express + WebSocket ì„œë²„ì—ì„œ ì²­í¬ ìˆ˜ì‹ 
6. **Whisper API**: OpenAI Whisperë¡œ ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
7. **í…ìŠ¤íŠ¸ ê²°ê³¼**: í•œêµ­ì–´ í…ìŠ¤íŠ¸ ë°˜í™˜
8. **í´ë¼ì´ì–¸íŠ¸ ì „ì†¡**: WebSocketìœ¼ë¡œ ì „ì‚¬ ê²°ê³¼ ì‹¤ì‹œê°„ ì „ì†¡
9. **UI ì—…ë°ì´íŠ¸**: React ìƒíƒœ ì—…ë°ì´íŠ¸ë¡œ ì¦‰ì‹œ í™”ë©´ ë°˜ì˜

### 2. í…ìŠ¤íŠ¸ â†’ í‰ê°€ íŒŒì´í”„ë¼ì¸

```mermaid
graph TD
    A[ì „ì‚¬ í…ìŠ¤íŠ¸] --> B[LLM ë¶„ì„ ìš”ì²­]
    B --> C[ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìƒì„±]
    C --> D[GPT API í˜¸ì¶œ]
    D --> E[JSON ì‘ë‹µ ìˆ˜ì‹ ]
    E --> F[ì‘ë‹µ ê²€ì¦]
    F --> G[ê¸°ì¤€ ìƒíƒœ ì—…ë°ì´íŠ¸]
    G --> H[ì§ˆë¬¸ ìƒì„±]
    H --> I[ì§„í–‰ë¥  ê³„ì‚°]
    I --> J[UI ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸]
```

**ì²˜ë¦¬ ì‹œê°„ ë¶„ì„:**
- Whisper API: 300-800ms (ì˜¤ë””ì˜¤ ê¸¸ì´ì— ë¹„ë¡€)
- GPT API: 500-1500ms (í”„ë¡¬í”„íŠ¸ ë³µì¡ë„ì— ë”°ë¼)
- ì „ì²´ ì²˜ë¦¬: 1-2ì´ˆ ë‚´ì™¸

### 3. ì‹¤ì‹œê°„ ìƒíƒœ ë™ê¸°í™”

```typescript
// ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡ë˜ëŠ” ë©”ì‹œì§€ íƒ€ì…ë“¤
interface WebSocketMessage {
  type: 'transcription' | 'criteria_update' | 'next_questions' | 'progress_update';
  data: any;
}

// í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸ íë¦„
useEffect(() => {
  if (wsRef.current) {
    wsRef.current.onmessage = (event) => {
      const message: WebSocketMessage = JSON.parse(event.data);
      
      switch (message.type) {
        case 'transcription':
          // ì¢Œì¸¡ íŒ¨ë„: ìƒˆ ì „ì‚¬ ì¶”ê°€
          setTranscriptions(prev => [...prev, message.data]);
          break;
          
        case 'criteria_update':
          // ì¤‘ì•™ íŒ¨ë„: í‰ê°€ ê¸°ì¤€ ìƒíƒœ ë³€ê²½
          setCriteriaUpdates(prev => [...prev, ...message.data]);
          break;
          
        case 'next_questions':
          // ìš°ì¸¡ íŒ¨ë„: ì œì•ˆ ì§ˆë¬¸ ì—…ë°ì´íŠ¸
          setNextQuestions(message.data);
          break;
          
        case 'progress_update':
          // ì¤‘ì•™ íŒ¨ë„: ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
          setProgress(message.data);
          break;
      }
    };
  }
}, [wsRef.current]);
```

---

## í™˜ê²½ ì„¤ì • ë° ë°°í¬

### 1. í™˜ê²½ë³€ìˆ˜ êµ¬ì„±

#### í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ (`.env.local`)
```bash
# ì˜¤ë””ì˜¤ ì„¤ì •
NEXT_PUBLIC_AUDIO_CHUNK_DURATION_SECONDS=5

# ì„œë²„ URL ì„¤ì •
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001
NEXT_PUBLIC_WS_URL=ws://localhost:8080
```

#### ì„œë²„ ì‚¬ì´ë“œ (`server/.env`)
```bash
# OpenAI API ì„¤ì •
OPENAI_API_KEY=sk-proj-...

# ì„œë²„ í¬íŠ¸ ì„¤ì •
SERVER_PORT=3001
WS_PORT=8080

# ì˜¤ë””ì˜¤ ì²˜ë¦¬ ì„¤ì •
CHUNK_PROCESSING_LIMIT=3           # ë™ì‹œ ì²˜ë¦¬ ê°€ëŠ¥í•œ ì²­í¬ ìˆ˜
WHISPER_MODEL=whisper-1            # ì‚¬ìš©í•  Whisper ëª¨ë¸
AUDIO_CHUNK_DURATION_SECONDS=5     # ì„œë²„ì‚¬ì´ë“œ ì²­í¬ ê¸¸ì´

# ê°œë°œ í™˜ê²½ ì„¤ì •
NODE_ENV=development
```

### 2. ê°œë°œ ì„œë²„ ì‹¤í–‰

#### í‘œì¤€ ì‹¤í–‰ ìˆœì„œ (CLAUDE.md ì°¸ì¡°)
```bash
# 1. í¬íŠ¸ ì •ë¦¬ (í˜¹ì‹œ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ)
lsof -ti:3000 | xargs kill -9 2>/dev/null || true
lsof -ti:3001 | xargs kill -9 2>/dev/null || true  
lsof -ti:8080 | xargs kill -9 2>/dev/null || true

# 2. í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ ì‹œì‘ (í¬íŠ¸ 3000)
npm run dev &

# 3. ë°±ì—”ë“œ ì„œë²„ ì‹œì‘ (í¬íŠ¸ 3001, WebSocket 8080)
cd server && npm run dev &
```

### 3. ì„±ëŠ¥ ìµœì í™” ì„¤ì •

#### ì˜¤ë””ì˜¤ í’ˆì§ˆ vs íŒŒì¼ í¬ê¸°
```typescript
// ê³ í’ˆì§ˆ (ë” í° íŒŒì¼)
audio: {
  sampleRate: 44100,      // CD í’ˆì§ˆ
  channelCount: 2,        // ìŠ¤í…Œë ˆì˜¤
  audioBitsPerSecond: 256000
}

// ê· í˜• (í˜„ì¬ ì„¤ì •)
audio: {
  sampleRate: 16000,      // Whisper ìµœì í™”
  channelCount: 1,        // ëª¨ë…¸
  audioBitsPerSecond: 128000
}

// ìµœì í™” (ë” ì‘ì€ íŒŒì¼)
audio: {
  sampleRate: 8000,       // ìŒì„± í†µí™” í’ˆì§ˆ
  channelCount: 1,        // ëª¨ë…¸
  audioBitsPerSecond: 64000
}
```

#### í™˜ê²½ë³„ ì²­í¬ ê¸¸ì´ ê¶Œì¥ì‚¬í•­
```bash
# ê°œë°œ í™˜ê²½ (ë¹ ë¥¸ í…ŒìŠ¤íŠ¸)
AUDIO_CHUNK_DURATION_SECONDS=3

# ìŠ¤í…Œì´ì§• í™˜ê²½ (ì‹¤ì œì™€ ìœ ì‚¬)
AUDIO_CHUNK_DURATION_SECONDS=5

# í”„ë¡œë•ì…˜ í™˜ê²½ (ì•ˆì •ì„± ìš°ì„ )
AUDIO_CHUNK_DURATION_SECONDS=7
```

### 4. ì—ëŸ¬ ì²˜ë¦¬ ë° ë””ë²„ê¹…

#### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

**1. ë§ˆì´í¬ ê¶Œí•œ ë¬¸ì œ**
```typescript
// ë¸Œë¼ìš°ì € ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ HTTPSì—ì„œë§Œ ë§ˆì´í¬ ì ‘ê·¼ ê°€ëŠ¥
if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
  console.error('HTTPS í™˜ê²½ì—ì„œë§Œ ë§ˆì´í¬ ì‚¬ìš© ê°€ëŠ¥');
}
```

**2. WebSocket ì—°ê²° ì‹¤íŒ¨**
```typescript
// ë°©í™”ë²½ì´ë‚˜ í”„ë¡ì‹œì—ì„œ WebSocket ì°¨ë‹¨í•  ìˆ˜ ìˆìŒ
const wsUrl = process.env.NODE_ENV === 'production' 
  ? 'wss://your-domain.com/ws'  // í”„ë¡œë•ì…˜ì—ì„œëŠ” WSS ì‚¬ìš©
  : 'ws://localhost:8080';       // ê°œë°œí™˜ê²½ì—ì„œëŠ” WS ì‚¬ìš©
```

**3. OpenAI API ì˜¤ë¥˜**
```typescript
// API í‚¤ ë˜ëŠ” í• ë‹¹ëŸ‰ ë¬¸ì œ
if (!process.env.OPENAI_API_KEY) {
  throw new Error('OPENAI_API_KEY í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ');
}

// ìš”ì²­ ì œí•œ ì²˜ë¦¬
if (error.response?.status === 429) {
  console.error('OpenAI API ìš”ì²­ í•œë„ ì´ˆê³¼');
  // ì¬ì‹œë„ ë¡œì§ êµ¬í˜„
}
```

#### íŠ¸ë ˆì´ì‹±ìœ¼ë¡œ ë¬¸ì œ ì§„ë‹¨
```typescript
// LLM í˜¸ì¶œ ê³¼ì •ì—ì„œ ë¬¸ì œ ë°œìƒ ì‹œ ë¡œê·¸ í™•ì¸
ğŸš€ [LLM-abc123] í˜¸ì¶œ ì‹œì‘
ğŸ“ [LLM-abc123] ì…ë ¥ í…ìŠ¤íŠ¸: "ì•ˆë…•í•˜ì„¸ìš”..."
ğŸ“Š [LLM-abc123] í…œí”Œë¦¿: í”„ë¡ íŠ¸ì—”ë“œ ì£¼ë‹ˆì–´ ê°œë°œì (8ê°œ ê¸°ì¤€)
ğŸ§  [LLM-abc123] ëª¨ë¸: gpt-4o-mini
ğŸ“„ [LLM-abc123] í”„ë¡¬í”„íŠ¸ ê¸¸ì´: 1205ì
â±ï¸ [LLM-abc123] API í˜¸ì¶œ ì‹œê°„: 850ms
ğŸ’° [LLM-abc123] í† í° ì‚¬ìš©ëŸ‰: 456 + 128 = 584
ğŸ“¤ [LLM-abc123] ì‘ë‹µ ê¸¸ì´: 312ì
âœ… [LLM-abc123] ì²˜ë¦¬ ì™„ë£Œ: 2ê°œ ê¸°ì¤€ ì—…ë°ì´íŠ¸, 1ê°œ ì§ˆë¬¸ ìƒì„±
â±ï¸ [LLM-abc123] ì´ ì²˜ë¦¬ ì‹œê°„: 892ms
```

ì´ ê°€ì´ë“œë¥¼ í†µí•´ ì´ˆë³´ìë„ ì‹¤ì‹œê°„ ë©´ì ‘ ì½”íŒŒì¼ëŸ¿ì˜ ëª¨ë“  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì„ ì´í•´í•˜ê³ , í•„ìš”ì— ë”°ë¼ ìˆ˜ì •í•˜ê±°ë‚˜ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.